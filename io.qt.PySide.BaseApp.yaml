id: io.qt.PySide.BaseApp
branch: '6.8'
runtime: org.kde.Platform
runtime-version: '6.8'
sdk: org.kde.Sdk
sdk-extensions:
  - org.freedesktop.Sdk.Extension.llvm18
separate-locales: false
base: io.qt.qtwebengine.BaseApp
base-version: '6.8'
build-options:
  append-path: /usr/lib/sdk/llvm18/bin
  append-ld-library-path: /usr/lib/sdk/llvm18/lib
  env:
    LLVM_INSTALL_DIR: /usr/lib/sdk/llvm18
    SHIBOKEN_DEBUG_LEVEL: 'full'
modules:
  - python3-requirements.json
  - name: pyside-setup
    buildsystem: simple
    build-commands:
      - python3 setup.py build --qtpaths=/usr/bin/qtpaths --ignore-git --parallel=8
        --log-level=verbose --no-qt-tools --flatpak
      - python3 create_wheels.py --build-dir ./build/qfp-*-release
      - rm -rf ./dist/PySide6_Examples*.whl
      - pip install ./dist/*.whl --prefix=${FLATPAK_DEST}
    sources:
      - type: git
        url: "https://code.qt.io/pyside/pyside-setup.git"
        tag: "v6.8.2"
  - name: polish
    buildsystem: simple
    build-commands:
      - mv ${FLATPAK_DEST}/cleanup-BaseApp{,-QtWebEngine}.sh
      - install -Dm755 cleanup.sh ${FLATPAK_DEST}/cleanup-BaseApp.sh
      - install -Dm644 ${FLATPAK_ID}.metainfo.xml -t ${FLATPAK_DEST}/share/metainfo/
    sources:
      - type: file
        path: cleanup.sh
      - type: file
        path: io.qt.PySide.BaseApp.metainfo.xml
